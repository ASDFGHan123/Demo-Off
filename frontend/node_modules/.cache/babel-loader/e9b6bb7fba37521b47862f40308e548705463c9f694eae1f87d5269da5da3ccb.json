{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,ListGroup,Alert,Spinner}from'react-bootstrap';import{Link}from'react-router-dom';import{chatAPI}from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatList=()=>{const[conversations,setConversations]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');useEffect(()=>{loadConversations();},[]);const loadConversations=async()=>{try{setLoading(true);const response=await chatAPI.getConversations();setConversations(response.data);}catch(err){setError('Failed to load conversations');console.error('Error loading conversations:',err);}finally{setLoading(false);}};const formatLastMessage=conversation=>{if(!conversation.last_message){return'No messages yet';}const{content,sender,sent_at}=conversation.last_message;const date=new Date(sent_at).toLocaleDateString();return\"\".concat(sender.display_name,\": \").concat(content.substring(0,50)).concat(content.length>50?'...':'',\" (\").concat(date,\")\");};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(Spinner,{animation:\"border\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading conversations...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Your Chats\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/create-private\",className:\"btn btn-primary me-2\",children:\"New Private Chat\"}),/*#__PURE__*/_jsx(Link,{to:\"/create-group\",className:\"btn btn-success\",children:\"New Group Chat\"})]})]}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error}),conversations.length===0?/*#__PURE__*/_jsxs(Alert,{variant:\"info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"No chats yet!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Start a conversation to see your chats here.\"})]}):/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:conversations.map(conversation=>/*#__PURE__*/_jsxs(ListGroup.Item,{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"strong\",{children:conversation.type==='private'?'Private Chat':conversation.title||'Group Chat'}),/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-primary ms-2\",children:conversation.type})]}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:formatLastMessage(conversation)})]}),/*#__PURE__*/_jsx(Link,{to:\"/chat/\".concat(conversation.conversation_id),className:\"btn btn-outline-primary btn-sm\",children:\"Open Chat\"})]},conversation.conversation_id))})})]});};export default ChatList;","map":{"version":3,"names":["React","useState","useEffect","Card","ListGroup","Alert","Spinner","Link","chatAPI","jsx","_jsx","jsxs","_jsxs","ChatList","conversations","setConversations","loading","setLoading","error","setError","loadConversations","response","getConversations","data","err","console","formatLastMessage","conversation","last_message","content","sender","sent_at","date","Date","toLocaleDateString","concat","display_name","substring","length","className","children","animation","to","variant","map","Item","type","title","conversation_id"],"sources":["c:/Users/salaam/Desktop/OffChat/frontend/src/components/chat/ChatList.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Card, ListGroup, Button, Alert, Spinner } from 'react-bootstrap';\r\nimport { Link } from 'react-router-dom';\r\nimport { chatAPI } from '../../services/api';\r\n\r\ninterface Conversation {\r\n  conversation_id: number;\r\n  type: 'private' | 'group';\r\n  title?: string;\r\n  last_message?: {\r\n    content: string;\r\n    sent_at: string;\r\n    sender: {\r\n      display_name: string;\r\n    };\r\n  };\r\n}\r\n\r\nconst ChatList: React.FC = () => {\r\n  const [conversations, setConversations] = useState<Conversation[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    loadConversations();\r\n  }, []);\r\n\r\n  const loadConversations = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await chatAPI.getConversations();\r\n      setConversations(response.data);\r\n    } catch (err) {\r\n      setError('Failed to load conversations');\r\n      console.error('Error loading conversations:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const formatLastMessage = (conversation: Conversation) => {\r\n    if (!conversation.last_message) {\r\n      return 'No messages yet';\r\n    }\r\n\r\n    const { content, sender, sent_at } = conversation.last_message;\r\n    const date = new Date(sent_at).toLocaleDateString();\r\n    return `${sender.display_name}: ${content.substring(0, 50)}${content.length > 50 ? '...' : ''} (${date})`;\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"text-center\">\r\n        <Spinner animation=\"border\" />\r\n        <p>Loading conversations...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"d-flex justify-content-between align-items-center mb-4\">\r\n        <h1>Your Chats</h1>\r\n        <div>\r\n          <Link to=\"/create-private\" className=\"btn btn-primary me-2\">\r\n            New Private Chat\r\n          </Link>\r\n          <Link to=\"/create-group\" className=\"btn btn-success\">\r\n            New Group Chat\r\n          </Link>\r\n        </div>\r\n      </div>\r\n\r\n      {error && <Alert variant=\"danger\">{error}</Alert>}\r\n\r\n      {conversations.length === 0 ? (\r\n        <Alert variant=\"info\">\r\n          <h4>No chats yet!</h4>\r\n          <p>Start a conversation to see your chats here.</p>\r\n        </Alert>\r\n      ) : (\r\n        <Card>\r\n          <ListGroup variant=\"flush\">\r\n            {conversations.map((conversation) => (\r\n              <ListGroup.Item\r\n                key={conversation.conversation_id}\r\n                className=\"d-flex justify-content-between align-items-center\"\r\n              >\r\n                <div className=\"flex-grow-1\">\r\n                  <div className=\"d-flex align-items-center\">\r\n                    <strong>\r\n                      {conversation.type === 'private' ? 'Private Chat' : (conversation.title || 'Group Chat')}\r\n                    </strong>\r\n                    <span className=\"badge bg-primary ms-2\">\r\n                      {conversation.type}\r\n                    </span>\r\n                  </div>\r\n                  <small className=\"text-muted\">\r\n                    {formatLastMessage(conversation)}\r\n                  </small>\r\n                </div>\r\n                <Link\r\n                  to={`/chat/${conversation.conversation_id}`}\r\n                  className=\"btn btn-outline-primary btn-sm\"\r\n                >\r\n                  Open Chat\r\n                </Link>\r\n              </ListGroup.Item>\r\n            ))}\r\n          </ListGroup>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}