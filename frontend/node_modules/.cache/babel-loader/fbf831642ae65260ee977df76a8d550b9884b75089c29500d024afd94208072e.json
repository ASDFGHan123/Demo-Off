{"ast":null,"code":"import axios from'axios';const API_BASE_URL=process.env.REACT_APP_API_URL||'';const api=axios.create({baseURL:API_BASE_URL,withCredentials:true,headers:{'Content-Type':'application/json'}});// Request interceptor to add CSRF token\napi.interceptors.request.use(config=>{const csrfToken=getCsrfToken();if(csrfToken){config.headers['X-CSRFToken']=csrfToken;}return config;});function getCsrfToken(){var _document$cookie$spli;const csrfToken=(_document$cookie$spli=document.cookie.split('; ').find(row=>row.startsWith('csrftoken=')))===null||_document$cookie$spli===void 0?void 0:_document$cookie$spli.split('=')[1];return csrfToken||null;}// Auth API\nexport const authAPI={login:(username,password)=>api.post('/login/',{username,password},{headers:{'Content-Type':'application/x-www-form-urlencoded'}}),register:userData=>api.post('/register/',userData,{headers:{'Content-Type':'application/x-www-form-urlencoded'}}),logout:()=>api.post('/logout/'),getCurrentUser:()=>api.get('/api/auth/user/')};// Chat API\nexport const chatAPI={getConversations:()=>api.get('/api/conversations/'),getConversation:id=>api.get(\"/api/conversations/\".concat(id,\"/\")),getMessages:conversationId=>api.get(\"/api/conversations/\".concat(conversationId,\"/messages/\")),sendMessage:(conversationId,content,replyTo)=>api.post(\"/chat/\".concat(conversationId,\"/send/\"),{content,reply_to:replyTo}),createPrivateChat:userId=>api.post('/api/create-private-chat/',{user_id:userId}),createGroupChat:data=>api.post('/api/create-group-chat/',data),searchMessages:query=>api.get('/api/search/messages/',{params:{q:query}})};// User API\nexport const userAPI={searchUsers:query=>api.get('/search/',{params:{q:query}}),getUsers:()=>api.get('/api/users/'),getUser:id=>api.get(\"/api/users/\".concat(id,\"/\")),updateUser:(id,data)=>api.put(\"/api/users/\".concat(id,\"/\"),data)};// File upload API\nexport const fileAPI={uploadAttachment:(file,messageId)=>{const formData=new FormData();formData.append('file',file);formData.append('message_id',messageId.toString());return api.post('/upload-attachment/',formData,{headers:{'Content-Type':'multipart/form-data'}});}};export default api;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","api","create","baseURL","withCredentials","headers","interceptors","request","use","config","csrfToken","getCsrfToken","_document$cookie$spli","document","cookie","split","find","row","startsWith","authAPI","login","username","password","post","register","userData","logout","getCurrentUser","get","chatAPI","getConversations","getConversation","id","concat","getMessages","conversationId","sendMessage","content","replyTo","reply_to","createPrivateChat","userId","user_id","createGroupChat","data","searchMessages","query","params","q","userAPI","searchUsers","getUsers","getUser","updateUser","put","fileAPI","uploadAttachment","file","messageId","formData","FormData","append","toString"],"sources":["c:/Users/salaam/Desktop/OffChat/frontend/src/services/api.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  withCredentials: true,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Request interceptor to add CSRF token\r\napi.interceptors.request.use((config) => {\r\n  const csrfToken = getCsrfToken();\r\n  if (csrfToken) {\r\n    config.headers['X-CSRFToken'] = csrfToken;\r\n  }\r\n  return config;\r\n});\r\n\r\nfunction getCsrfToken(): string | null {\r\n  const csrfToken = document.cookie\r\n    .split('; ')\r\n    .find(row => row.startsWith('csrftoken='))\r\n    ?.split('=')[1];\r\n  return csrfToken || null;\r\n}\r\n\r\n// Auth API\r\nexport const authAPI = {\r\n  login: (username: string, password: string) =>\r\n    api.post('/login/', { username, password }, {\r\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n    }),\r\n\r\n  register: (userData: any) =>\r\n    api.post('/register/', userData, {\r\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n    }),\r\n\r\n  logout: () => api.post('/logout/'),\r\n\r\n  getCurrentUser: () => api.get('/api/auth/user/'),\r\n};\r\n\r\n// Chat API\r\nexport const chatAPI = {\r\n  getConversations: () => api.get('/api/conversations/'),\r\n\r\n  getConversation: (id: number) => api.get(`/api/conversations/${id}/`),\r\n\r\n  getMessages: (conversationId: number) => api.get(`/api/conversations/${conversationId}/messages/`),\r\n\r\n  sendMessage: (conversationId: number, content: string, replyTo?: number) =>\r\n    api.post(`/chat/${conversationId}/send/`, { content, reply_to: replyTo }),\r\n\r\n  createPrivateChat: (userId: number) =>\r\n    api.post('/api/create-private-chat/', { user_id: userId }),\r\n\r\n  createGroupChat: (data: { title: string; member_ids: number[]; description?: string }) =>\r\n    api.post('/api/create-group-chat/', data),\r\n\r\n  searchMessages: (query: string) =>\r\n    api.get('/api/search/messages/', { params: { q: query } }),\r\n};\r\n\r\n// User API\r\nexport const userAPI = {\r\n  searchUsers: (query: string) => api.get('/search/', { params: { q: query } }),\r\n\r\n  getUsers: () => api.get('/api/users/'),\r\n\r\n  getUser: (id: number) => api.get(`/api/users/${id}/`),\r\n\r\n  updateUser: (id: number, data: any) => api.put(`/api/users/${id}/`, data),\r\n};\r\n\r\n// File upload API\r\nexport const fileAPI = {\r\n  uploadAttachment: (file: File, messageId: number) => {\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    formData.append('message_id', messageId.toString());\r\n\r\n    return api.post('/upload-attachment/', formData, {\r\n      headers: { 'Content-Type': 'multipart/form-data' }\r\n    });\r\n  },\r\n};\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}